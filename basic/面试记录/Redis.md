- [redis](https://www.nowcoder.com/jump/super-jump/word?word=redis)[源码](https://www.nowcoder.com/jump/super-jump/word?word=源码)中list怎么实现，应用场景，看了有什么收获

答：在3.2之前redis中列表由linked list或者ziplist实现

双向linkedlist是一个c语言结构体实现了一个多态链表，链表其中除了常规的链表结点外，在没有模板的情况下为了实现多态，使用void*指针和几个函数指针作为必要的回调函数（类似成员函数）（match，free，dup深拷贝）

ziplist：为了节约空间而实现了压缩列表，压缩列表是一个显式的链表，它没有前后指针，通过每个节点中存储前一个节点大小和当前节点大小进行遍历。



应用场景：当列表数据中字符串长度小于64字节且元素数量小于512个使用ziplist



收获：linkedlist让我对c++的多态以及发展有了更深的理解，redis使用c语言实现了c++中的多态以及类似于成员函数，dup函数就好像c++中的拷贝构造，普通的=号只能浅拷贝地址，唯有实现dup拷贝函数拷贝一个结点

ziplist的实现让我联想到了内存堆的分配和管理，其中为了使管理内存的链表尽可能多的留下可使用的空间，也没有直接存储地址（8字节）而是用头部和尾部实现，同样是根据节点大小充当了指针





redis各种类型，如何实现？

string最大存多少数据？ 512M

- String value最大可以存储==512M==
- hash键值对个数最多为$2^{32}-1$​，即4294967295个
- List元素个数最多为$2^{32}-1$个，即4294967295个
- Set元素个数最多为$2^{32}-1$个，即4294967295个^
- SortSet元素个数最多为$2^{32}-1$个，即4294967295个

整数，浮点数如何存储？ 

- 字符串对象存储
- 将浮点数，整数先转换成字符串对象。取出的时候再转换回来







### rehash

- [redis](https://www.nowcoder.com/jump/super-jump/word?word=redis)中hash怎么实现、rehash、渐进式rehash

rehash：扩展和收缩哈希表

什么时候触发？

负载因子怎么算？



### redis为啥使用单线程？





### redis key-value用什么策略管理

既然你说可以用lru淘汰缓存，并且可以定时删掉一些key，那么你来设计数据结构来实现这俩功能一起使用



### redis实例和多redis



## 持久化

RDB是什么？全量备份（二进制文件，有点像binlog？），无法做到实时持久化

AOF是什么？保存的是每一条写命令（文本文件）



### RDB redis database

RDB的优势：

- 某个时间点的快照，全量备份，替换之前的rdb文件
- 加载RDB比AOF快

- 支持多进程，子进程进行保存操作， 父进程没有磁盘IO。性能优于RDB

RDB的缺点：

- 数据安全性低，是一段时间间隔进行持久化，可能会出现数据丢失情况
- 由于是多线程完成，数据量较大的 会占用更多的cpu时间

###AOF append only file

Aof会丢失数据吗？

- 有可能会丢失，看设置同步时间





### key值过大的危害

1. 大key和大value的危害是一致的：内存不均、阻塞请求、阻塞网络。
2. key由于比value需要做更多的操作如hashcode、链表中比较等操作，所以会比value更多一些内存相关开销。

