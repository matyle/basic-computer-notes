笔记-《Linux内核设计与实现》

## 编译内核

[编译内核](/Users/matytan/Desktop/code/基础/linux内核相关/Linux1-2.md)

## 内核开发特点

- 不能访问C库也不能访问标准C头文件（只能使用内核中实现的）
- 必须使用GNU C
- 没有内存保护机制
- 难以执行浮点运算
- 内核进程只有一个很小的定长堆栈
- 时刻注意同步和并发（支持异步中断，抢占和SMP）



> 常用c库在内核中实现了

例如string函数，位于`lib/string.c`文件中

体系结构相关的头文件位于`arch/.../include/asm`目录下





### GNU C的特点

1. 内联函数（inline）

- 优点：消除函数调用和返回的开销
- 缺点：增加代码长度，占用更多的空间和指令缓存



2. 内联汇编 （需要再看看基本语法）
3. 分支声明：优化指令

### 没有内存保护机制

- 不会检查非法内存越界
- 防止非法访问内存
- 防止空指针
- 内存不分页，用掉一个字节，物理内存就少了一个字节！！

### 不要轻易在内核中使用浮点数

### 容积小而固定的栈

32位–8kb

64位–16kb 栈大小

### 同步和并发

- 支持对称多处理器系统，因此可能会有2个处理器同时访问资源的情况

### 可移植重要性

